{"version":3,"file":"histore.js","sources":["../histore.js"],"sourcesContent":["/**\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default function histore() {\n\t// Server\n\tif (typeof history === 'undefined') {\n\t\treturn { get() {}, set () {} };\n\t}\n\n\tlet transit = {}\n\tlet empty = {}\n\n\tconst previousReplaceState = history.replaceState\n\tconst previousPushState = history.pushState\n\n\tconst get = key => history.state && history.state[key];\n\tconst set = (key, value) => {\n\t\ttransit[key] = value;\n\n\t\t//const state = {};\n\t\t//state[key] = value;\n\t\t//history.replaceState(state);\n\t};\n\tconst setEmpty = (obj) => {\n\t\tempty = obj;\n\t};\n\tconst flush = () => {\n\t\thistory.replaceState(transit, document.title);\n\t}\n\tconst wrapPush = m => (state, title, url) => {\n\t\tpreviousReplaceState(Object.assign({}, history.state, transit), document.title)\n\n\t\t// Reset transit\n\t\ttransit = {}\n\t\tfor (var prop in empty) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(empty, prop)) {\n\t\t\t\ttransit[prop] = obj[prop];\n\t\t\t}\n\t\t}\n\n\t\treturn m.call(history, Object.assign({}, history.state, state || {}, transit), title, url)\n\t}\n\tconst wrap = m => (state, title, url) => {\n\t\treturn m.call(history, Object.assign({}, history.state, state || {}, transit), title, url)\n\t}\n\thistory.pushState = wrapPush(history.pushState);\n\thistory.replaceState = wrap(history.replaceState);\n\treturn { set, get, flush, setEmpty };\n}\n"],"names":["history","get","set","let","m","transit","empty","previousReplaceState","replaceState","pushState","state","title","url","prop","Object","assign","document","prototype","hasOwnProperty","call","obj","wrap","key","value"],"mappings":"eAae,WAEd,GAAuB,oBAAZA,QACV,OAASC,iBAAUC,kBAGpBC,IAoBiBC,EApBbC,KACAC,KAEEC,EAAuBP,QAAQQ,aAmCrC,OAlC0BR,QAgC1BA,QAAQS,WAhBSL,EAgBYJ,QAAQS,mBAhBdC,EAAOC,EAAOC,GAKpC,IAAK,IAAIC,KAJTN,EAAqBO,OAAOC,UAAWf,QAAQU,MAAOL,GAAUW,SAASL,OAGzEN,KACiBC,EACZQ,OAAOG,UAAUC,eAAeC,KAAKb,EAAOO,KAC/CR,EAAQQ,GAAQO,IAAIP,IAItB,OAAOT,EAAEe,KAAKnB,QAASc,OAAOC,UAAWf,QAAQU,MAAOA,MAAaL,GAAUM,EAAOC,KAMvFZ,QAAQQ,sBAJKJ,mBAAMM,EAAOC,EAAOC,UACzBR,EAAEe,KAAKnB,QAASc,OAAOC,UAAWf,QAAQU,MAAOA,MAAaL,GAAUM,EAAOC,IAGhES,CAAKrB,QAAQQ,4BA9BvBc,EAAKC,GACjBlB,EAAQiB,GAAOC,gBAFJD,UAAOtB,QAAQU,OAASV,QAAQU,MAAMY,qBAYjDtB,QAAQQ,aAAaH,EAASW,SAASL,0BAJtBS,GACjBd,EAAQc"}